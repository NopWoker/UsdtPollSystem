import{a as V}from"./user-CznRQ-zt.js";import{t as G,c as N}from"./index-Dz-O0943.js";import{M as P}from"./@arco-design-uttiljWv.js";import{r as p,c as T,a as h,h as m,j as z,k as E,l as a,t as e,a1 as g,O as H}from"./@vue-9ZIPiVZG.js";import"./@wangeditor-Bg8kJaak.js";import"./pinia-CtMvrpix.js";import"./axios-BOAqGR8s.js";import"./crypto-js-B6um_4t4.js";import"./lodash-fWIJiXPB.js";import"./qs-CGfOb-kZ.js";import"./side-channel-0xN0c_x9.js";import"./es-errors-CFxpeikN.js";import"./object-inspect-Pz2pmunN.js";import"./side-channel-list-asz5kCf8.js";import"./side-channel-map-DBz1yoQn.js";import"./get-intrinsic-CCph2EoF.js";import"./es-object-atoms-Ditt1eQ6.js";import"./math-intrinsics-Cv-yPkyD.js";import"./gopd-fcd2-aIC.js";import"./es-define-property-bDCdrV83.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-cKMTtFGz.js";import"./dunder-proto-CiSsr-aM.js";import"./call-bind-apply-helpers-DFdvRtIg.js";import"./function-bind-CHqF18-c.js";import"./hasown-DwiY0sux.js";import"./call-bound-BMZ_xw6V.js";import"./side-channel-weakmap-CMrfu08b.js";import"./vue-router-DXldG2q0.js";import"./nprogress-DxiOKil-.js";import"./monaco-editor-nMXQdunA.js";import"./file2md5-B4-SI92N.js";import"./spark-md5-D8tidE2e.js";import"./lodash.noop-BeiKyXVG.js";import"./vue-color-kit-w75Wyu4C.js";import"./vue-clipboard3-DpvFlCWw.js";import"./clipboard-ehac6u_s.js";import"./vue-echarts-B-rvonkO.js";import"./resize-detector-G6vbKCU7.js";import"./echarts-Cz-L25MO.js";import"./tslib-BDyQ-Jie.js";import"./zrender-xbpiMqDc.js";import"./@iconify-BfRLEUc9.js";import"./vue-i18n-PeqK6azz.js";import"./@intlify-CJ2pDqUV.js";import"./vue-QIJ1KGct.js";import"./dayjs-DUkVwsK-.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./compute-scroll-into-view-1gs_hJI2.js";import"./b-tween-BtQQsX34.js";import"./number-precision-BW_FzNZC.js";import"./scroll-into-view-if-needed-SxpMpKWN.js";import"./b-validate-DHOn5MGm.js";import"./color-JIMhKyf3.js";import"./color-string-Ckj7g19G.js";import"./color-name-BQ5IbGbl.js";import"./simple-swizzle-BUB9Iq-C.js";import"./is-arrayish-BII_q15j.js";const We={__name:"edit",emits:["success"],setup(I,{expose:U,emit:y}){const x=y,_=p(),u=p(""),f=p(!1),v=p(!1),b=p([]);p([]);let D=T(()=>"用户管理"+(u.value=="add"?"-新增":"-编辑"));const w={id:"",avatar:"",username:"",nickname:"",dept_id:"",password:"",role_ids:[],phone:"",post_ids:[],email:"",status:1,remark:""},o=h({...w}),C={username:[{required:!0,message:"账户不能为空"}],password:[{required:!0,message:"密码不能为空"}],role_ids:[{required:!0,message:"角色不能为空"}]},R=async(s="add",t="")=>{if(u.value=s,Object.assign(o,w),_.value.clearValidate(),f.value=!0,await q(),s=="edit"){const{data:d}=await V.read(t);if(d.postList){const r=d.postList.map(n=>n.id);d.post_ids=r}const i=d.roleList.map(r=>r.id);d.role_ids=i,d.password="",k(d)}},q=async()=>{const s=await N.commonGet("/core/role/accessRole");b.value=s.data},k=async s=>{for(const t in o)s[t]!=null&&s[t]!=null&&(o[t]=s[t])},B=async s=>{var d;if(!await((d=_.value)==null?void 0:d.validate())){v.value=!0;let i={...o},r={};u.value==="add"?(i.id=void 0,r=await V.save(i)):r=await V.update(i.id,i),r.code===200&&(P.success("操作成功"),x("success"),s(!0)),setTimeout(()=>{v.value=!1},500)}s(!1)},L=()=>f.value=!1;return U({open:R,setFormData:k}),(s,t)=>{const d=m("sa-upload-image"),i=m("a-form-item"),r=m("a-col"),n=m("a-row"),c=m("a-input"),O=m("a-tree-select"),j=m("a-input-password"),F=m("sa-radio"),M=m("a-textarea"),A=m("a-form");return E(),z(H("a-modal"),{visible:f.value,"onUpdate:visible":t[9]||(t[9]=l=>f.value=l),width:g(G).getDevice()==="mobile"?"100%":"800px",title:g(D),"mask-closable":!1,"ok-loading":v.value,onCancel:L,onBeforeOk:B},{default:a(()=>[e(A,{ref_key:"formRef",ref:_,model:o,rules:C,"auto-label-width":!0},{default:a(()=>[e(n,{gutter:16},{default:a(()=>[e(r,{span:24},{default:a(()=>[e(i,{label:"头像",field:"avatar"},{default:a(()=>[e(d,{modelValue:o.avatar,"onUpdate:modelValue":t[0]||(t[0]=l=>o.avatar=l),rounded:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(n,{gutter:16},{default:a(()=>[e(r,{span:12},{default:a(()=>[e(i,{field:"username",label:"账户"},{default:a(()=>[e(c,{modelValue:o.username,"onUpdate:modelValue":t[1]||(t[1]=l=>o.username=l),disabled:u.value==="edit",placeholder:"请输入账户"},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(i,{field:"role_ids",label:"角色"},{default:a(()=>[e(O,{modelValue:o.role_ids,"onUpdate:modelValue":t[2]||(t[2]=l=>o.role_ids=l),data:b.value,"field-names":{key:"value",title:"label"},"tree-check-strictly":!0,"allow-clear":"","tree-checkable":"",placeholder:"请选择角色"},null,8,["modelValue","data"])]),_:1})]),_:1})]),_:1}),e(n,{gutter:16},{default:a(()=>[e(r,{span:12},{default:a(()=>[e(i,{field:"password",label:"密码"},{default:a(()=>[e(j,{modelValue:o.password,"onUpdate:modelValue":t[3]||(t[3]=l=>o.password=l),disabled:u.value==="edit",placeholder:"请输入密码"},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(i,{field:"nickname",label:"昵称"},{default:a(()=>[e(c,{modelValue:o.nickname,"onUpdate:modelValue":t[4]||(t[4]=l=>o.nickname=l),placeholder:"请输入昵称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(n,{gutter:16},{default:a(()=>[e(r,{span:12},{default:a(()=>[e(i,{field:"phone",label:"手机"},{default:a(()=>[e(c,{modelValue:o.phone,"onUpdate:modelValue":t[5]||(t[5]=l=>o.phone=l),placeholder:"请输入手机"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(i,{field:"email",label:"邮箱"},{default:a(()=>[e(c,{modelValue:o.email,"onUpdate:modelValue":t[6]||(t[6]=l=>o.email=l),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(n,{gutter:16}),e(n,{gutter:16},{default:a(()=>[e(r,{span:24},{default:a(()=>[e(i,{label:"状态",field:"status"},{default:a(()=>[e(F,{modelValue:o.status,"onUpdate:modelValue":t[7]||(t[7]=l=>o.status=l),dict:"data_status",placeholder:"请选择状态"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(n,{gutter:16},{default:a(()=>[e(r,{span:24},{default:a(()=>[e(i,{label:"备注",field:"remark"},{default:a(()=>[e(M,{modelValue:o.remark,"onUpdate:modelValue":t[8]||(t[8]=l=>o.remark=l),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},40,["visible","width","title","ok-loading"])}}};export{We as default};
